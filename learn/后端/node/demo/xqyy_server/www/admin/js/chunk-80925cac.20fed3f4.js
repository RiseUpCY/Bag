(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-80925cac"],{"1bc0":function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("editor",{ref:"editor",attrs:{value:t.content},on:{"on-change":t.handleChange}})],1)},s=[],i=o("a0f0"),r={name:"editor_page",components:{Editor:i["a"]},props:{content:{type:String,default:"请输入内容"}},methods:{handleChange:function(t,e){this.$emit("html-changed",t)},changeContent:function(t){this.$refs.editor.setHtml(t)}},watch:{content:function(t){this.changeContent(t)}}},n=r,l=(o("40b9"),o("2877")),m=Object(l["a"])(n,a,s,!1,null,null,null);m.options.__file="editor.vue";e["a"]=m.exports},2891:function(t,e,o){"use strict";var a=o("69c0"),s=o.n(a);s.a},"40b9":function(t,e,o){"use strict";var a=o("42b4"),s=o.n(a);s.a},"42b4":function(t,e,o){},"69c0":function(t,e,o){},"9e20":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("Card",[o("p",{attrs:{slot:"title"},slot:"title"},[o("Icon",{attrs:{type:"ios-image-outline"}}),t._v("\n        "+t._s(t.id?t.image.title:"新建")+"的图片信息\n      ")],1),o("div",{staticClass:"form-wapper"},[o("Form",{ref:"formCustom",attrs:{model:t.formCustom,"label-width":80}},[o("FormItem",{attrs:{label:"文章标题",prop:"title"}},[o("Input",{attrs:{type:"text"},model:{value:t.formCustom.title,callback:function(e){t.$set(t.formCustom,"title",e)},expression:"formCustom.title"}})],1),o("FormItem",{attrs:{label:"文章简介",prop:"profile"}},[o("Input",{attrs:{type:"textarea"},model:{value:t.formCustom.profile,callback:function(e){t.$set(t.formCustom,"profile",e)},expression:"formCustom.profile"}})],1),o("FormItem",{attrs:{label:"文章状态",prop:"state"}},[o("RadioGroup",{model:{value:t.formCustom.state,callback:function(e){t.$set(t.formCustom,"state",e)},expression:"formCustom.state"}},[t.viewAccessSuper?o("Radio",{attrs:{label:"publish"}},[t._v("已发布")]):t._e(),o("Radio",{attrs:{label:"store"}},[t._v("未发布")]),o("Radio",{attrs:{label:"trash"}},[t._v("垃圾箱")])],1)],1),o("Row",[o("Col",{attrs:{span:"6"}},[o("FormItem",{attrs:{label:"发布人",prop:"editor"}},[o("Input",{attrs:{type:"text",disabled:""},model:{value:t.formCustom.editor,callback:function(e){t.$set(t.formCustom,"editor",e)},expression:"formCustom.editor"}})],1)],1),o("Col",{attrs:{span:"6",offset:"4"}},[o("FormItem",{attrs:{label:"价格",prop:"price"}},[o("Input",{attrs:{type:"text",placeholder:"有需要时填写"},model:{value:t.formCustom.price,callback:function(e){t.$set(t.formCustom,"price",e)},expression:"formCustom.price"}})],1)],1)],1),o("Row",[o("Col",{attrs:{span:"6"}},[o("FormItem",{staticClass:"layer-up-one",attrs:{label:"文章类别",prop:"type"}},[o("Select",{staticStyle:{width:"200px"},model:{value:t.formCustom.type,callback:function(e){t.$set(t.formCustom,"type",e)},expression:"formCustom.type"}},t._l(t.articleTypes,function(e,a){return o("OptionGroup",{key:a,attrs:{label:e.parent}},t._l(e.children,function(e){return o("Option",{key:e.mark,attrs:{value:e.mark}},[t._v(t._s(e.title))])}))}))],1)],1),o("Col",{attrs:{span:"6",push:"4"}},[o("FormItem",{staticClass:"layer-up-one",attrs:{label:"展示位置",prop:"type"}},[o("Select",{staticStyle:{width:"200px"},model:{value:t.formCustom.imgcate,callback:function(e){t.$set(t.formCustom,"imgcate",e)},expression:"formCustom.imgcate"}},t._l(t.imagecateMap,function(e){return o("Option",{key:e.value,attrs:{value:e.value}},[t._v("\n                  "+t._s(e.label)+"\n                ")])}))],1)],1)],1),o("Row",{staticClass:"layer-up-two"},[o("Col",{attrs:{span:"10"}},[o("FormItem",{attrs:{label:"发布日期",prop:"date"}},[o("DatePicker",{attrs:{type:"date",placeholder:"Select date"},model:{value:t.formCustom.date,callback:function(e){t.$set(t.formCustom,"date",e)},expression:"formCustom.date"}})],1)],1),o("Col",{staticStyle:{"text-align":"center"},attrs:{span:"2"}}),o("Col",{attrs:{span:"10"}},[o("FormItem",{attrs:{prop:"time"}},[o("TimePicker",{attrs:{type:"time",placeholder:"Select time"},model:{value:t.formCustom.time,callback:function(e){t.$set(t.formCustom,"time",e)},expression:"formCustom.time"}})],1)],1)],1),o("FormItem",{attrs:{label:"图片列表",prop:"content"}},[t._l(t.formCustom.imgUrls,function(e,a){return o("Card",{key:a,staticClass:"img-card",staticStyle:{overflow:"hidden"}},[o("img",{staticStyle:{height:"100%",width:"100%"},attrs:{src:e},on:{click:function(o){t.handleImgClick(e)}}})])}),o("Upload",{attrs:{multiple:"",type:"drag","show-upload-list":!1,format:["jpg","jpeg","png","gif"],action:t.upimgAddr,"with-credentials":!0,"on-success":t.upImgSuccess,"on-format-error":t.handleFormatError}},[o("div",{staticStyle:{padding:"20px 0"}},[o("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),o("p",[t._v("Click or drag files here to upload")])],1)]),o("Modal",{attrs:{title:"查看图片","ok-text":"删除","cancel-text":"返回"},on:{"on-ok":function(e){t.modalImgCallback(t.modalImg.url)}},model:{value:t.modalImg.visible,callback:function(e){t.$set(t.modalImg,"visible",e)},expression:"modalImg.visible"}},[t.modalImg.visible?o("img",{staticStyle:{width:"100%"},attrs:{src:t.modalImg.url}}):t._e()])],2),o("FormItem",{staticClass:"wang-editor",attrs:{label:"文章内容",prop:"content"}},[o("wangEditor",{attrs:{content:t.content},on:{"html-changed":t.htmlChange}})],1),o("FormItem",[o("Button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit("formCustom")}}},[t._v("Submit")]),o("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){t.handleReset("formCustom")}}},[t._v("Reset")])],1)],1)],1)])],1)},s=[],i=(o("f751"),o("28a5"),o("20d6"),o("7f7f"),o("1bc0")),r=o("7e1e"),n=o("90de"),l=o("88ec"),m=o("1b62"),c=o("f121"),u={mixins:[m["a"]],name:"userdetail",data:function(){return{id:void 0,upimgAddr:c["a"].testUrl+"image/upload",imagecateMap:[],image:{},modalImg:{url:"",visible:!1},content:"",formCustom:{title:"",profile:"",state:"store",editor:"",type:"",date:"",time:"",imgUrls:[],content:"",imgcate:0,price:null}}},methods:{upImgSuccess:function(t){this.$Message.success({content:"上传成功"}),0===t.code&&this.formCustom.imgUrls.push(t.data)},handleFormatError:function(t){this.$Notice.warning({title:"文件类型错误",desc:"File format of "+t.name+" is incorrect, 请选择jpg,jpeg,png,gif类型文件."})},handleImgClick:function(t){t&&(this.modalImg.visible=!0,this.modalImg.url=t,console.log(t))},modalImgCallback:function(t){var e=this;this.$Modal.confirm({title:"删除提示",content:"删除图片后就无法恢复！",onOk:function(){Object(r["f"])(t).then(function(o){if(0===o.code){var a=e.formCustom.imgUrls.findIndex(function(e){return e===t});a>=0&&e.formCustom.imgUrls.splice(a,1)}else e.$Message.error("未知错误，删除失败")})}})},handleSubmit:function(){var t=this;if(confirm("你确定要提交吗？")){var e=this.formCustom.type.split("-");this.formCustom.cateid=e[0]?e[0]:0,this.formCustom.cateindex=e[1];var o=this.formCustom,a=o.date,s=o.time;if(a||s){if(a||(a=(new Date).getTime()),s){var i=s.split(":");a.setHours(i[0]),a.setMinutes(i[1]),a.setSeconds(i[2])}this.formCustom.create_time=a.getTime()}this.id||(this.formCustom.editor_id=this.userId),Object(r["e"])(this.id,this.formCustom).then(function(e){0===e.code?t.$Message.success(t.id?"修改成功":"上传成功"):t.$Message.error(e.data)}).catch(function(e){t.$Message.error(e.data)})}},htmlChange:function(t){this.formCustom.content=t},handleReset:function(){this.formCustom=Object(n["a"])(this.image),this.reSetContent(this.formCustom.content)},reSetContent:function(t){var e=this;this.content="",this.$nextTick(function(){e.content=t})}},mounted:function(){var t=this,e=this.$route.query.id;if(this.imagecateMap=l["a"],this.id=e,!e)return this.content="  ",this.$nextTick(function(){t.content=""}),this.formCustom.editor=this.name,void this.reSetContent(" ");Object(r["c"])(e).then(function(e){e.data&&e.data.id&&(t.formCustom=Object.assign(t.formCustom,e.data,{type:"".concat(e.data.cateid,"-").concat(e.data.cateindex)}),t.image=Object(n["a"])(t.formCustom),t.reSetContent(t.formCustom.content))})},computed:{viewAccessSuper:function(){return Object(n["e"])(["super_admin"],this.access)},articleTypes:function(){return Object(l["c"])("image","imagelist")}},components:{wangEditor:i["a"]}},d=u,f=(o("2891"),o("2877")),p=Object(f["a"])(d,a,s,!1,null,"472713e4",null);p.options.__file="image_modify.vue";e["default"]=p.exports}}]);